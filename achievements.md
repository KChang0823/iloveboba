# 成就系統邏輯說明

這份文件詳細說明了目前「我超愛喝手搖」應用程式中的成就系統邏輯。

## 成就列表

### 1. 土豪金 (Rich)
*   **描述**：找出所有價格超過 80 元的飲料。
*   **觸發邏輯**：
    *   系統會檢查使用者的所有飲料紀錄。
    *   若單杯飲料價格 `> 80` 元，即視為達成。
    *   **判定方式**：`d.price > 80`

### 2. 專情的人 (Loyal)
*   **描述**：連續 3 次喝同一店家同一品項。
*   **觸發邏輯**：
    *   將使用者的飲料紀錄按下單時間排序。
    *   檢查連續的紀錄是否為**同一店家 (`shopName`)** 且 **同一品項 (`itemName`)**。
    *   若連續次數達到 **3 次**或以上，即達成成就。
    *   中間若有穿插其他店家的飲料，計數將會重置。

### 3. 嘗百草 (Explorer)
*   **描述**：單月內喝了超過 5 家不同的店。
*   **觸發邏輯**：
    *   將飲料紀錄按「月份」(YYYY-MM) 分組。
    *   在同一個月份內，計算**不重複的店家名稱 (`shopName`)** 數量。
    *   若該月份的不重複店家數量 `>= 5` 家，即達成該月份的成就。

### 4. 心有靈犀 (Copycat)
*   **描述**：同一天雙方喝了一模一樣的飲料。
*   **觸發邏輯**：
    *   系統會檢查每一天的紀錄。
    *   當天必須**包含自己與對方**的紀錄。
    *   若自己的一杯飲料與對方的任一杯飲料完全匹配，條件包含：
        1.  **店家 (`shopName`)** 相同
        2.  **品項 (`itemName`)** 相同
        3.  **冰塊 (`ice`)** 相同
        4.  **甜度 (`sugar`)** 相同
    *   完全符合上述四點，即達成成就。

### 5. 獨吞大師 (Solo)
*   **描述**：累積連續 5 天只有自己喝，對方沒喝。
*   **觸發邏輯**：
    *   系統檢查每一天 (Date) 的所有紀錄。
    *   若某一天**只有自己有喝**，且**對方完全沒喝**，則計為「獨吞日」。
    *   此成就需要 **連續 5 天** 達成獨吞條件。
    *   **重置條件**：如果尚未累積滿 5 天，對方就喝了飲料（即中斷了連續獨吞），計數將會重新歸 0 計算。
    *   **判定方式**：連續 5 天滿足「當天 records 中 `hasMe` 為真且 `!hasOther` 為真」。
